## HashMap、Hashtable、ConcurrentHashMap三者对比

|                    | **HashMap**                                     | **Hashtable**                                    | **ConcurrentHashMap**                                        |
| ------------------ | ----------------------------------------------- | ------------------------------------------------ | ------------------------------------------------------------ |
| 是否线程安全       | 否                                              | 是                                               | 是                                                           |
| 线程安全采用的方式 |                                                 | 采用 synchronized 类锁,效率低                    | 采用 CAS + synchronized ,锁住的只有当前操作的 bucket ,不影响其他线程对 bucket的操作,效率高 |
| 数据结构           | 数组 + 链表 + 红黑树(链表长度超过8则转为红黑树) | 数组 + 链表                                      | 数组 + 链表 + 红黑树 (链表长度超过8则转为红黑树)             |
| 是否允许 null 值   | 是                                              | 否                                               | 否                                                           |
| 哈希地址算法       | (key的hashCode)^(key的hashCodde无符号右移16位)  | key的hashCodde                                   | ((key的hashCode)^(key的hashCode无符号右移16位)&0*7fffffff    |
| 定位算法           | 哈希地址&(容量大小-1)                           | (哈希地址&0*7fffffff)%容量大小                   | 哈希地址&(容量大小-1)                                        |
| 扩容算法           | 当键值对数量大于阈值,则容量扩容到原来的2倍      | 当键值对数量大于等于阈值.则容量扩容到原来的2倍+1 | 当键值对数量大于等于sizeCtl,单线程创建新哈希表,多线程复制bucket到新哈希表,容量扩容到原来的2倍 |
| 链表插入           | 将新节点插入到链表尾部                          | 将新节点插入链表的头部                           | 将新节点插入到链表的尾部                                     |
| 继承的类           | 继承 abstractMap 抽象类                         | 继承 Dictiopnary 抽象类                          | 继承 abstractMap 抽象类                                      |
| 实现的接口         | 实现 Map 接口                                   | 实现 Map 接口                                    | 实现 concurrentMap 接口                                      |
| 默认容量大小       | 16                                              | 11                                               | 16                                                           |
| 默认负载因子       | 0.75                                            | 0.75                                             | 0.75                                                         |
| 统计 size 方式     | 直接返回成员变量 size                           | 直接返回成员变量 count                           | 遍历 ConsurrentCell 数组的值进行累加,最后加上 baseCount 的值即为 size |

